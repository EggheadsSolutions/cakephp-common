# Фикстуры таблиц

Для того, чтобы в тесте можно было использовать таблицы из БД нужно в классе этого теста описать свойство $fixtures, например:
```php
/** @inheritdoc */
public $fixtures = [
    AS_P_ITEMS, // в случае применения построителя сущностей EntityBuilder
    'app.vtiger_products', // по-умолчанию
    'VtigerProductcf', // CamelCase
];
```
Во время теста структуры таблиц копируются из коннекта БД ```default``` в коннект ```test```, далее заполняются данными из xml файла либо из свойства `$records` фикстуры. После выполнения теста все таблицы из конфига ```test``` 
удаляются, соответственно для каждого тестового класса нужно описывать абсолютно все применяемые таблицы.

## Заполнение тестовых таблиц данными

### Объявить CamelCase класс с в `tests\Fixture`
Таким образом мы можем объявить только глобальные фикстуры (т.е. данные будут одни и те же на протяжении всех тестов).
Например, в папке `tests\Fixture` создать класс `TableNameFixture` (вместо TableName - нужная таблица) и определить в ней свойство $records. Например, в `VtigerCrmentitySeqFixture`:
```php
/** @inheritdoc */
public $records = [
    ['id' => '1000000000'],
];
```
### Использовать XML файл формата Mysql через MysqlWorkbench
Имя xml файла должно совпадать с именем таблицы MySQL.
Расположение файлов:
* `tests\Fixture\Data` для глобальных фукстур.
* Локальные  фукстуры располагаются в папке тестового класса. 

При загрузке фикстур сначала ищутся локальные, потом глобальные.

### Правила

Использование одних и тех же фикстур для разных тестов оказалось не самым удачным решением, т.к. во-первых, тесты получаются зависимыми друг от друга, и правка фикстур для одного теста часто заваливала другие тесты, 
во-вторых, при правке одной и той же фикстуры двумя людьми операция мержа превращалась в ад.

Так что самый правильный вариант: для каждого теста создаётся своя папка и все нужные для него фикстуры кладутся туда.
